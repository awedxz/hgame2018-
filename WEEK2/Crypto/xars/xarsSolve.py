from pwn import *
import time
context.log_level = 'debug'

r = remote('spineee.space', 23555)

def sendMsg(str):
	r.recvuntil('give me you text:')
	r.sendline(str)
	r.recvuntil('result:')
	time.sleep(0.1)
	data = r.recv(numb=2048)
	return data[1:-1]

def xor(a, b):
    return ''.join([chr(ord(x[0]) ^ ord(x[1])) for x in zip(a, b)])

def add(a, b):
    return ''.join([chr((ord(x[0]) + ord(x[1])) % 256) for x in zip(a, b)])

def enc1(key, msg):
    msg = xor(key, msg)
    msg = add(key, msg)
    return msg

# c = "bd5595fd55f57d5d356d059dbda5fd250da525a55d95b5b58d3dddddd5ed85ed" a*32
c = "1aae0ab62a8ed696aac62a661a0af66aa6eaea7eb60aceeac6dadad62a5a6eda" # z*32
l1 = list(c.decode('hex'))
for i in range(1, 31):
    l2 = list('z' * 32)
    mabey = []
    for j in range(33, 127):
    	# print chr(j)
        l2[i - 1] = enc1(chr(j), 'z')
        want = enc1(chr(j), l1[i])
        # print ord(want)
        sendStr = ''.join(l2)
        # print sendStr
        if list(sendMsg(sendStr).decode('hex'))[i - 1] == want:
            mabey.append(chr(j))
    print i, mabey

# 'a'*32   bd5595fd55f57d5d356d059dbda5fd250da525a55d95b5b58d3dddddd5ed85ed
# 1 ['&', "'", 'N', 'O', 'f', 'g'] g
# 2 ['`', 'a', 'h', 'i']           a
# 3 [',', '-', 'L', 'M', 'l', 'm'] m
# 4 ['$', '%', 'd', 'e']           e
# 5 [':', ';', 'Z', '[', 'z', '{'] {
# 6 ['.', '/', 'N', 'O', 'n', 'o']
# 7 ['0', '1', 'p', 'q']
# 8 ['T', 'U', 'V', 'W', 't', 'u', 'v', 'w']
# 9 ['>', '?', '^', '_', '~']       
# 10 ['<', '=', 'T', 'U', 'l', 'm']
# 11 ['$', '%', '^', '_']           
# 12 ['0', '1', 'J', 'K', 'j', 'k']
# 13 ['6', '7', 'F', 'G', 'N', 'O', '^', '_', 'f', 'g', 'n', 'o', '~'] 
# 14 ['.', '/', 'N', 'O', 'n', 'o']
# 15 ['>', '?', 'F', 'G', 'N', 'O', 'V', 'W', 'f', 'g', 'n', 'o', 'v', 'w']
# 16 ['^', '_'] 
# 17 ['F', 'G', 'N', 'O', 'V', 'W', '^', '_', 'f', 'g', 'n', 'o', 'v', 'w', '~'] 
# 18 ['0', '1', '@', 'A', 'H', 'I', 'X', 'Y', '`', 'a', 'h', 'i', 'x', 'y']
# 19 ['(', ')', '0', '1', '@', 'A', 'X', 'Y', '`', 'a', 'x', 'y']
# 20 ['4', '5', 't', 'u']
# 21 ['6', '7', 'L', 'M', '^', '_']
# 22 ['"', '#', '0', '1', '8', '9']
# 23 ['!', '(', ')', 'R', 'S', 'r', 's']
# 24 ['D', 'E', 'N', 'O', '^', '_']
# 25 ['8', '9', 'B', 'C', 'b', 'c']
# 26 ['P', 'Q']
# 27 ['@', 'A']
# 28 ['<', '=', 'T', 'U', 'V', 'W', '|', '}']
# 29 ['.', '/', '>', '?', 'N', 'O', '^', '_', 'n', 'o', '~']
# 30 ['<', '=', 'D', 'E', 'l', 'm']

# 'z' * 32   1aae0ab62a8ed696aac62a661a0af66aa6eaea7eb60aceeac6dadad62a5a6eda
# 1 ['E', 'G', 'M', 'O', 'e', 'g', 'm', 'o']
# 2 ['a', 'c', 'i', 'k']
# 3 ['M', 'O', ']', '_', 'm', 'o', '}']
# 4 ['E', 'G', 'M', 'O', 'e', 'g', 'm', 'o']
# 5 ['q', 's', 'y', '{']
# 6 ['L', 'N', '\\', '^']
# 7 ['"', '0', '2']
# 8 ['U', 'W', ']', '_', 'u', 'w', '}']
# 9 [']', '_']
# 10 ['U', 'W', ']', '_', 'u', 'w', '}']
# 11 ['=', '?', ']', '_', '}']
# 12 ['a', 'c', 'i', 'k', 'q', 's', 'y', '{']
# 13 ['d', 'f', 'l', 'n']
# 14 ['-', '/', '=', '?', 'M', 'O', ']', '_', 'm', 'o', '}']
# 15 ['5', '7', '=', '?', 'U', 'W', ']', '_', 'u', 'w', '}']
# 16 [']', '_', '}']
# 17 ['5', '7', '=', '?', 'U', 'W', ']', '_', 'u', 'w', '}']
# 18 ['"', '(', '*', '@', 'B', 'H', 'J', '`', 'b', 'h', 'j']
# 19 ['!', '#', ')', '+', '1', '3', '9', ';', 'A', 'C', 'I', 'K', 'Q', 'S', 'Y', '[', 'a', 'c', 'i', 'k', 'q', 's', 'y', '{']
# 20 ['D', 'F', 'T', 'V', 'd', 'f', 't', 'v']
# 21 ['U', 'W', ']', '_']
# 22 ['1', '3', '9', ';', 'q', 's', 'y', '{']
# 23 ['1', '3', '9', ';', 'Q', 'S', 'Y', '[', 'q', 's', 'y', '{']
# 24 [']', '_']
# 25 ['A', 'C', 'I', 'K', 'Q', 'S', 'Y', '[']
# 26 ['@', 'B', 'H', 'J', 'P', 'R', 'X', 'Z']
# 27 ['A', 'C', 'Q', 'S']
# 28 ['5', '7', '=', '?']
# 29 ['$', '&', ',', '.', '4', '6', '<', '>', 'd', 'f', 'l', 'n', 't', 'v', '|', '~']
# 30 ['5', '7', '=', '?', 'U', 'W', ']', '_', 'u', 'w', '}']

# 'i' * 32  756d6d950d2d35152d05dd95355df57d65fdfdfd954d8d0d851535b56d059d85
# 1 ['&', "'", '.', '/', 'F', 'G', 'N', 'O', 'f', 'g', 'n', 'o']
# 2 ['!', '(', ')', '0', '1', '8', '9', '@', 'A', 'H', 'I', 'P', 'Q', 'X', 'Y', '`', 'a', 'h', 'i', 'p', 'q', 'x', 'y']
# 3 ['V', 'W', 'l', 'm']
# 4 ['4', '5', '<', '=', 'd', 'e', 'l', 'm']
# 5 ['"', '#', '*', '+', 'R', 'S', 'Z', '[', 'r', 's', 'z', '{']
# 6 ['L', 'M', 'N', 'O', 'l', 'm', 'n', 'o']
# 7 ['0', '1', 'r', 's']
# 8 ['$', '%', '&', "'", ',', '-', '.', '/', '4', '5', '<', '=', 'V', 'W', '^', '_', 'v', 'w', '~']
# 9 ['D', 'E', 'T', 'U', '^', '_']
# 10 ['T', 'U', '\\', ']']
# 11 ['$', '%', '^', '_']
# 12 ['0', '1', 'J', 'K', 'j', 'k']
# 13 ['&', "'", '.', '/', 'f', 'g', 'n', 'o']
# 14 ['.', '/', 'N', 'O', 'n', 'o']
# 15 ['6', '7', '>', '?', 'V', 'W', '^', '_', 'v', 'w', '~']
# 16 ['>', '?', '^', '_', '~']
# 17 ['6', '7', '>', '?', 'V', 'W', '^', '_', 'v', 'w', '~']
# 18 ['!', '(', ')', '@', 'A', 'H', 'I', '`', 'a', 'h', 'i']
# 19 ['!', '(', ')', '@', 'A', 'H', 'I', '`', 'a', 'h', 'i']
# 20 ['F', 'G', 't', 'u']
# 21 ['V', 'W', '^', '_']
# 22 ['0', '1', '8', '9', '`', 'a', 'h', 'i']
# 23 ['"', '#', '*', '+', '@', 'A', 'H', 'I', 'P', 'Q', 'X', 'Y', 'r', 's', 'z', '{']
# 24 ['D', 'E', 'N', 'O', 'T', 'U', '^', '_']
# 25 ['B', 'C', 'X', 'Y']
# 26 ['2', '3', 'P', 'Q', 'p', 'q']
# 27 ['"', '#', '@', 'A', '`', 'a']
# 28 ['$', '%', ',', '-', '4', '5', '<', '=', 'D', 'E', 'L', 'M', 'T', 'U', '\\', ']', 'd', 'e', 'l', 'm', 't', 'u', '|', '}']
# 29 ['.', '/', '~']
# 30 ['4', '5', '<', '=']

# hgame{N0w_U_knoW_What_1s_CPA=.=}
# hgame{N0(Ww)_U_k(fn)(/Oo)(Ww)_(Ww)(@Hh)(Aa)t_(19)s_CPA=(.~)=}

